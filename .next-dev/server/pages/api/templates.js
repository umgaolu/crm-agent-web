"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/templates";
exports.ids = ["pages/api/templates"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@supabase/supabase-js");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftemplates&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctemplates%5Cindex.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftemplates&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctemplates%5Cindex.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_templates_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\templates\\index.ts */ \"(api)/./pages/api/templates/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_templates_index_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_templates_index_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_templates_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_templates_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/templates\",\n        pathname: \"/api/templates\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_templates_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnRlbXBsYXRlcyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDdGVtcGxhdGVzJTVDaW5kZXgudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDOEQ7QUFDOUQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLDBEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQywwREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jcm0tYWdlbnQtd2ViLz8yNzg0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcdGVtcGxhdGVzXFxcXGluZGV4LnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdGVtcGxhdGVzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGVtcGxhdGVzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftemplates&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctemplates%5Cindex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/templates/index.ts":
/*!**************************************!*\
  !*** ./pages/api/templates/index.ts ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__]);\n_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nfunction readEnv(value) {\n    const raw = value !== null && value !== undefined ? String(value).trim() : \"\";\n    if (!raw) {\n        return \"\";\n    }\n    return raw.replace(/^['\"`]/, \"\").replace(/['\"`]$/, \"\").trim();\n}\nconst supabaseUrl = readEnv(\"https://vvrokpefmojngpoxvsan.supabase.co\");\nconst supabaseKey = readEnv(\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2cm9rcGVmbW9qbmdwb3h2c2FuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4MzUzNTIsImV4cCI6MjA4MzQxMTM1Mn0.t-tHn0A7uzizGEytzeaNvz-i5BGL9sqq-yGOvGE2crQ\" || 0);\nconst supabaseServiceKey = readEnv(process.env.SUPABASE_SERVICE_KEY);\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseKey || \"\");\nconst adminSupabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey || supabaseKey || \"\");\nfunction getTemplateId(source) {\n    const value = source.id ?? source.temp_id ?? source.template_id ?? source.tempId ?? source.templateId ?? source.uuid ?? \"\";\n    return value !== null && value !== undefined ? String(value) : \"\";\n}\nfunction normalizeTemplateRow(row) {\n    const source = row || {};\n    return {\n        id: getTemplateId(source),\n        name: source.temp_name ? String(source.temp_name) : source.name ? String(source.name) : \"\",\n        type: source.temp_type ? String(source.temp_type) : source.type ? String(source.type) : \"\",\n        path: source.temp_path ? String(source.temp_path) : source.path ? String(source.path) : \"\",\n        creator: source.created_by ? String(source.created_by) : \"\",\n        createdAt: source.created_at ? String(source.created_at) : \"\",\n        updatedAt: source.updated_at ? String(source.updated_at) : \"\"\n    };\n}\nasync function queryTemplates(params) {\n    const keyword = params.keyword.trim();\n    const idFields = [\n        \"id\",\n        \"temp_id\",\n        \"template_id\"\n    ];\n    const orderFields = [\n        \"updated_at\",\n        \"modified_at\",\n        \"created_at\"\n    ];\n    const baseFields = \"temp_name,temp_type,temp_path,created_by,created_at,updated_at\";\n    let lastError = null;\n    for (const idField of idFields){\n        for (const orderField of orderFields){\n            let query = supabase.from(\"document_templates\").select(`${idField},${baseFields}`).limit(200);\n            if (keyword) {\n                query = query.ilike(\"temp_name\", `%${keyword}%`);\n            }\n            const { data, error } = await query.order(orderField, {\n                ascending: false\n            });\n            if (!error) {\n                return Array.isArray(data) ? data : [];\n            }\n            lastError = error;\n            const msg = error.message || \"\";\n            if (/column .* does not exist/i.test(msg)) {\n                continue;\n            }\n            throw new Error(msg || \"查询失败\");\n        }\n    }\n    if (lastError) {\n        throw new Error(lastError.message || \"查询失败\");\n    }\n    return [];\n}\nfunction toStringSafe(value) {\n    if (value === null || value === undefined) {\n        return \"\";\n    }\n    return String(value);\n}\nasync function insertTemplate(params) {\n    const nowIso = new Date().toISOString();\n    const name = params.name.trim() || \"新模板\";\n    const type = params.type.trim() || \"周报\";\n    const createdBy = params.createdBy.trim() || \"系统\";\n    const reportTitle = params.reportTitle ? String(params.reportTitle) : undefined;\n    const paramType = params.paramType ? String(params.paramType) : undefined;\n    const text = params.text ? String(params.text) : undefined;\n    const inputPath = params.path !== undefined ? String(params.path) : \"\";\n    const safePath = inputPath;\n    const baseExtra = {};\n    if (reportTitle !== undefined) {\n        baseExtra.report_title = reportTitle;\n    }\n    if (paramType !== undefined) {\n        baseExtra.param_type = paramType;\n    }\n    const payloadCandidates = [\n        {\n            temp_name: name,\n            temp_type: type,\n            temp_path: safePath,\n            ...text !== undefined ? {\n                temp_text: text\n            } : {},\n            ...baseExtra,\n            created_by: createdBy,\n            created_at: nowIso,\n            updated_at: nowIso\n        },\n        {\n            temp_name: name,\n            temp_type: type,\n            temp_path: safePath,\n            ...text !== undefined ? {\n                temp_text: text\n            } : {},\n            ...baseExtra,\n            created_by: createdBy,\n            created_at: nowIso\n        },\n        {\n            temp_name: name,\n            temp_type: type,\n            temp_path: safePath,\n            ...text !== undefined ? {\n                temp_text: text\n            } : {},\n            ...baseExtra,\n            created_by: createdBy\n        },\n        {\n            name,\n            type,\n            path: safePath,\n            ...text !== undefined ? {\n                text\n            } : {},\n            ...baseExtra,\n            created_by: createdBy,\n            created_at: nowIso,\n            updated_at: nowIso\n        },\n        {\n            name,\n            type,\n            path: safePath,\n            ...text !== undefined ? {\n                text\n            } : {},\n            ...baseExtra,\n            created_by: createdBy,\n            created_at: nowIso\n        },\n        {\n            name,\n            type,\n            path: safePath,\n            ...text !== undefined ? {\n                text\n            } : {},\n            ...baseExtra,\n            created_by: createdBy\n        }\n    ];\n    let lastError = null;\n    for (const payload of payloadCandidates){\n        const { data, error } = await adminSupabase.from(\"document_templates\").insert(payload).select(\"*\").maybeSingle();\n        if (!error && data) {\n            return data;\n        }\n        lastError = error;\n        if (!error) {\n            continue;\n        }\n        const msg = error.message || \"\";\n        if (/column .* does not exist/i.test(msg)) {\n            continue;\n        }\n        break;\n    }\n    throw new Error(lastError?.message || \"创建失败\");\n}\nasync function handler(req, res) {\n    const expectedToken = process.env.CRM_API_TOKEN;\n    const headerToken = req.headers[\"x-crm-token\"];\n    const token = Array.isArray(headerToken) ? headerToken[0] : headerToken;\n    if (expectedToken && token !== expectedToken) {\n        res.status(401).json({\n            error: \"Unauthorized\"\n        });\n        return;\n    }\n    if (!supabaseUrl || !supabaseKey) {\n        res.status(500).json({\n            error: \"Supabase配置缺失\"\n        });\n        return;\n    }\n    if (req.method === \"GET\") {\n        const { keyword } = req.query;\n        const keywordValue = typeof keyword === \"string\" ? keyword.trim() : \"\";\n        try {\n            const rows = await queryTemplates({\n                keyword: keywordValue\n            });\n            res.status(200).json({\n                items: rows.map((row)=>normalizeTemplateRow(row))\n            });\n        } catch (e) {\n            res.status(500).json({\n                error: e?.message || \"查询失败\"\n            });\n        }\n        return;\n    }\n    if (req.method === \"POST\") {\n        const body = req.body || {};\n        const name = toStringSafe(body.name);\n        const type = toStringSafe(body.type);\n        const createdBy = toStringSafe(body.createdBy);\n        const reportTitle = toStringSafe(body.reportTitle);\n        const paramType = toStringSafe(body.paramType);\n        const text = toStringSafe(body.text);\n        const path = toStringSafe(body.path);\n        try {\n            const row = await insertTemplate({\n                name,\n                type,\n                createdBy,\n                ...reportTitle ? {\n                    reportTitle\n                } : {},\n                ...paramType ? {\n                    paramType\n                } : {},\n                ...text ? {\n                    text\n                } : {},\n                ...path ? {\n                    path\n                } : {}\n            });\n            res.status(201).json({\n                item: normalizeTemplateRow(row)\n            });\n            return;\n        } catch (e) {\n            res.status(500).json({\n                error: e?.message || \"创建失败\"\n            });\n            return;\n        }\n    }\n    res.setHeader(\"Allow\", \"GET,POST\");\n    res.status(405).end(\"Method Not Allowed\");\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVRLE1BQU0xRSxxQkFBcUJDO1lBQUs7WUFDdkQ7UUFDRixFQUFFLE9BQU91RSxHQUFRO1lBQ2ZiLElBQUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVyQyxPQUFPMkMsR0FBR3JDLFdBQVc7WUFBTztZQUNuRDtRQUNGO0lBQ0Y7SUFFQXdCLElBQUlnQixTQUFTLENBQUMsU0FBUztJQUN2QmhCLElBQUlNLE1BQU0sQ0FBQyxLQUFLVyxHQUFHLENBQUM7QUFDdEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jcm0tYWdlbnQtd2ViLy4vcGFnZXMvYXBpL3RlbXBsYXRlcy9pbmRleC50cz9mYTk2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5cbmZ1bmN0aW9uIHJlYWRFbnYodmFsdWU6IHVua25vd24pIHtcbiAgY29uc3QgcmF3ID0gdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCA/IFN0cmluZyh2YWx1ZSkudHJpbSgpIDogXCJcIjtcbiAgaWYgKCFyYXcpIHtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxuICByZXR1cm4gcmF3LnJlcGxhY2UoL15bJ1wiYF0vLCBcIlwiKS5yZXBsYWNlKC9bJ1wiYF0kLywgXCJcIikudHJpbSgpO1xufVxuXG5jb25zdCBzdXBhYmFzZVVybCA9IHJlYWRFbnYocHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMKTtcbmNvbnN0IHN1cGFiYXNlS2V5ID0gcmVhZEVudihcbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgfHwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9LRVlcbik7XG5jb25zdCBzdXBhYmFzZVNlcnZpY2VLZXkgPSByZWFkRW52KHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfS0VZKTtcblxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlS2V5IHx8IFwiXCIpO1xuY29uc3QgYWRtaW5TdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChcbiAgc3VwYWJhc2VVcmwsXG4gIHN1cGFiYXNlU2VydmljZUtleSB8fCBzdXBhYmFzZUtleSB8fCBcIlwiXG4pO1xuXG5mdW5jdGlvbiBnZXRUZW1wbGF0ZUlkKHNvdXJjZTogUmVjb3JkPHN0cmluZywgYW55Pikge1xuICBjb25zdCB2YWx1ZSA9XG4gICAgc291cmNlLmlkID8/XG4gICAgc291cmNlLnRlbXBfaWQgPz9cbiAgICBzb3VyY2UudGVtcGxhdGVfaWQgPz9cbiAgICBzb3VyY2UudGVtcElkID8/XG4gICAgc291cmNlLnRlbXBsYXRlSWQgPz9cbiAgICBzb3VyY2UudXVpZCA/P1xuICAgIFwiXCI7XG4gIHJldHVybiB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gU3RyaW5nKHZhbHVlKSA6IFwiXCI7XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZVRlbXBsYXRlUm93KHJvdzogYW55KSB7XG4gIGNvbnN0IHNvdXJjZSA9IChyb3cgfHwge30pIGFzIFJlY29yZDxzdHJpbmcsIGFueT47XG4gIHJldHVybiB7XG4gICAgaWQ6IGdldFRlbXBsYXRlSWQoc291cmNlKSxcbiAgICBuYW1lOiBzb3VyY2UudGVtcF9uYW1lID8gU3RyaW5nKHNvdXJjZS50ZW1wX25hbWUpIDogc291cmNlLm5hbWUgPyBTdHJpbmcoc291cmNlLm5hbWUpIDogXCJcIixcbiAgICB0eXBlOiBzb3VyY2UudGVtcF90eXBlID8gU3RyaW5nKHNvdXJjZS50ZW1wX3R5cGUpIDogc291cmNlLnR5cGUgPyBTdHJpbmcoc291cmNlLnR5cGUpIDogXCJcIixcbiAgICBwYXRoOiBzb3VyY2UudGVtcF9wYXRoXG4gICAgICA/IFN0cmluZyhzb3VyY2UudGVtcF9wYXRoKVxuICAgICAgOiBzb3VyY2UucGF0aFxuICAgICAgICA/IFN0cmluZyhzb3VyY2UucGF0aClcbiAgICAgICAgOiBcIlwiLFxuICAgIGNyZWF0b3I6IHNvdXJjZS5jcmVhdGVkX2J5ID8gU3RyaW5nKHNvdXJjZS5jcmVhdGVkX2J5KSA6IFwiXCIsXG4gICAgY3JlYXRlZEF0OiBzb3VyY2UuY3JlYXRlZF9hdCA/IFN0cmluZyhzb3VyY2UuY3JlYXRlZF9hdCkgOiBcIlwiLFxuICAgIHVwZGF0ZWRBdDogc291cmNlLnVwZGF0ZWRfYXQgPyBTdHJpbmcoc291cmNlLnVwZGF0ZWRfYXQpIDogXCJcIlxuICB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBxdWVyeVRlbXBsYXRlcyhwYXJhbXM6IHsga2V5d29yZDogc3RyaW5nIH0pIHtcbiAgY29uc3Qga2V5d29yZCA9IHBhcmFtcy5rZXl3b3JkLnRyaW0oKTtcbiAgY29uc3QgaWRGaWVsZHMgPSBbXCJpZFwiLCBcInRlbXBfaWRcIiwgXCJ0ZW1wbGF0ZV9pZFwiXTtcbiAgY29uc3Qgb3JkZXJGaWVsZHMgPSBbXCJ1cGRhdGVkX2F0XCIsIFwibW9kaWZpZWRfYXRcIiwgXCJjcmVhdGVkX2F0XCJdO1xuICBjb25zdCBiYXNlRmllbGRzID0gXCJ0ZW1wX25hbWUsdGVtcF90eXBlLHRlbXBfcGF0aCxjcmVhdGVkX2J5LGNyZWF0ZWRfYXQsdXBkYXRlZF9hdFwiO1xuXG4gIGxldCBsYXN0RXJyb3I6IGFueSA9IG51bGw7XG5cbiAgZm9yIChjb25zdCBpZEZpZWxkIG9mIGlkRmllbGRzKSB7XG4gICAgZm9yIChjb25zdCBvcmRlckZpZWxkIG9mIG9yZGVyRmllbGRzKSB7XG4gICAgICBsZXQgcXVlcnkgPSAoc3VwYWJhc2UgYXMgYW55KVxuICAgICAgICAuZnJvbShcImRvY3VtZW50X3RlbXBsYXRlc1wiKVxuICAgICAgICAuc2VsZWN0KGAke2lkRmllbGR9LCR7YmFzZUZpZWxkc31gKVxuICAgICAgICAubGltaXQoMjAwKTtcblxuICAgICAgaWYgKGtleXdvcmQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5pbGlrZShcInRlbXBfbmFtZVwiLCBgJSR7a2V5d29yZH0lYCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5Lm9yZGVyKG9yZGVyRmllbGQsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcbiAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoZGF0YSkgPyBkYXRhIDogW107XG4gICAgICB9XG5cbiAgICAgIGxhc3RFcnJvciA9IGVycm9yO1xuICAgICAgY29uc3QgbXNnID0gZXJyb3IubWVzc2FnZSB8fCBcIlwiO1xuICAgICAgaWYgKC9jb2x1bW4gLiogZG9lcyBub3QgZXhpc3QvaS50ZXN0KG1zZykpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IobXNnIHx8IFwi5p+l6K+i5aSx6LSlXCIpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChsYXN0RXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IobGFzdEVycm9yLm1lc3NhZ2UgfHwgXCLmn6Xor6LlpLHotKVcIik7XG4gIH1cbiAgcmV0dXJuIFtdO1xufVxuXG5mdW5jdGlvbiB0b1N0cmluZ1NhZmUodmFsdWU6IHVua25vd24pIHtcbiAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxuICByZXR1cm4gU3RyaW5nKHZhbHVlKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaW5zZXJ0VGVtcGxhdGUocGFyYW1zOiB7IG5hbWU6IHN0cmluZzsgdHlwZTogc3RyaW5nOyBjcmVhdGVkQnk6IHN0cmluZyB9KSB7XG4gIGNvbnN0IG5vd0lzbyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgY29uc3QgbmFtZSA9IHBhcmFtcy5uYW1lLnRyaW0oKSB8fCBcIuaWsOaooeadv1wiO1xuICBjb25zdCB0eXBlID0gcGFyYW1zLnR5cGUudHJpbSgpIHx8IFwi5ZGo5oqlXCI7XG4gIGNvbnN0IGNyZWF0ZWRCeSA9IHBhcmFtcy5jcmVhdGVkQnkudHJpbSgpIHx8IFwi57O757ufXCI7XG5cbiAgY29uc3QgcmVwb3J0VGl0bGUgPSAocGFyYW1zIGFzIGFueSkucmVwb3J0VGl0bGUgPyBTdHJpbmcoKHBhcmFtcyBhcyBhbnkpLnJlcG9ydFRpdGxlKSA6IHVuZGVmaW5lZDtcbiAgY29uc3QgcGFyYW1UeXBlID0gKHBhcmFtcyBhcyBhbnkpLnBhcmFtVHlwZSA/IFN0cmluZygocGFyYW1zIGFzIGFueSkucGFyYW1UeXBlKSA6IHVuZGVmaW5lZDtcbiAgY29uc3QgdGV4dCA9IChwYXJhbXMgYXMgYW55KS50ZXh0ID8gU3RyaW5nKChwYXJhbXMgYXMgYW55KS50ZXh0KSA6IHVuZGVmaW5lZDtcbiAgY29uc3QgaW5wdXRQYXRoID0gKHBhcmFtcyBhcyBhbnkpLnBhdGggIT09IHVuZGVmaW5lZCA/IFN0cmluZygocGFyYW1zIGFzIGFueSkucGF0aCkgOiBcIlwiO1xuICBjb25zdCBzYWZlUGF0aCA9IGlucHV0UGF0aDtcblxuICBjb25zdCBiYXNlRXh0cmE6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgaWYgKHJlcG9ydFRpdGxlICE9PSB1bmRlZmluZWQpIHtcbiAgICBiYXNlRXh0cmEucmVwb3J0X3RpdGxlID0gcmVwb3J0VGl0bGU7XG4gIH1cbiAgaWYgKHBhcmFtVHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYmFzZUV4dHJhLnBhcmFtX3R5cGUgPSBwYXJhbVR5cGU7XG4gIH1cblxuICBjb25zdCBwYXlsb2FkQ2FuZGlkYXRlczogUmVjb3JkPHN0cmluZywgYW55PltdID0gW1xuICAgIHtcbiAgICAgIHRlbXBfbmFtZTogbmFtZSxcbiAgICAgIHRlbXBfdHlwZTogdHlwZSxcbiAgICAgIHRlbXBfcGF0aDogc2FmZVBhdGgsXG4gICAgICAuLi4odGV4dCAhPT0gdW5kZWZpbmVkID8geyB0ZW1wX3RleHQ6IHRleHQgfSA6IHt9KSxcbiAgICAgIC4uLmJhc2VFeHRyYSxcbiAgICAgIGNyZWF0ZWRfYnk6IGNyZWF0ZWRCeSxcbiAgICAgIGNyZWF0ZWRfYXQ6IG5vd0lzbyxcbiAgICAgIHVwZGF0ZWRfYXQ6IG5vd0lzb1xuICAgIH0sXG4gICAge1xuICAgICAgdGVtcF9uYW1lOiBuYW1lLFxuICAgICAgdGVtcF90eXBlOiB0eXBlLFxuICAgICAgdGVtcF9wYXRoOiBzYWZlUGF0aCxcbiAgICAgIC4uLih0ZXh0ICE9PSB1bmRlZmluZWQgPyB7IHRlbXBfdGV4dDogdGV4dCB9IDoge30pLFxuICAgICAgLi4uYmFzZUV4dHJhLFxuICAgICAgY3JlYXRlZF9ieTogY3JlYXRlZEJ5LFxuICAgICAgY3JlYXRlZF9hdDogbm93SXNvXG4gICAgfSxcbiAgICB7XG4gICAgICB0ZW1wX25hbWU6IG5hbWUsXG4gICAgICB0ZW1wX3R5cGU6IHR5cGUsXG4gICAgICB0ZW1wX3BhdGg6IHNhZmVQYXRoLFxuICAgICAgLi4uKHRleHQgIT09IHVuZGVmaW5lZCA/IHsgdGVtcF90ZXh0OiB0ZXh0IH0gOiB7fSksXG4gICAgICAuLi5iYXNlRXh0cmEsXG4gICAgICBjcmVhdGVkX2J5OiBjcmVhdGVkQnlcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWUsXG4gICAgICB0eXBlLFxuICAgICAgcGF0aDogc2FmZVBhdGgsXG4gICAgICAuLi4odGV4dCAhPT0gdW5kZWZpbmVkID8geyB0ZXh0IH0gOiB7fSksXG4gICAgICAuLi5iYXNlRXh0cmEsXG4gICAgICBjcmVhdGVkX2J5OiBjcmVhdGVkQnksXG4gICAgICBjcmVhdGVkX2F0OiBub3dJc28sXG4gICAgICB1cGRhdGVkX2F0OiBub3dJc29cbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWUsXG4gICAgICB0eXBlLFxuICAgICAgcGF0aDogc2FmZVBhdGgsXG4gICAgICAuLi4odGV4dCAhPT0gdW5kZWZpbmVkID8geyB0ZXh0IH0gOiB7fSksXG4gICAgICAuLi5iYXNlRXh0cmEsXG4gICAgICBjcmVhdGVkX2J5OiBjcmVhdGVkQnksXG4gICAgICBjcmVhdGVkX2F0OiBub3dJc29cbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWUsXG4gICAgICB0eXBlLFxuICAgICAgcGF0aDogc2FmZVBhdGgsXG4gICAgICAuLi4odGV4dCAhPT0gdW5kZWZpbmVkID8geyB0ZXh0IH0gOiB7fSksXG4gICAgICAuLi5iYXNlRXh0cmEsXG4gICAgICBjcmVhdGVkX2J5OiBjcmVhdGVkQnlcbiAgICB9XG4gIF07XG5cbiAgbGV0IGxhc3RFcnJvcjogYW55ID0gbnVsbDtcbiAgZm9yIChjb25zdCBwYXlsb2FkIG9mIHBheWxvYWRDYW5kaWRhdGVzKSB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgKGFkbWluU3VwYWJhc2UgYXMgYW55KVxuICAgICAgLmZyb20oXCJkb2N1bWVudF90ZW1wbGF0ZXNcIilcbiAgICAgIC5pbnNlcnQocGF5bG9hZClcbiAgICAgIC5zZWxlY3QoXCIqXCIpXG4gICAgICAubWF5YmVTaW5nbGUoKTtcbiAgICBpZiAoIWVycm9yICYmIGRhdGEpIHtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgICBsYXN0RXJyb3IgPSBlcnJvcjtcbiAgICBpZiAoIWVycm9yKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgbXNnID0gZXJyb3IubWVzc2FnZSB8fCBcIlwiO1xuICAgIGlmICgvY29sdW1uIC4qIGRvZXMgbm90IGV4aXN0L2kudGVzdChtc2cpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgYnJlYWs7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGxhc3RFcnJvcj8ubWVzc2FnZSB8fCBcIuWIm+W7uuWksei0pVwiKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCBleHBlY3RlZFRva2VuID0gcHJvY2Vzcy5lbnYuQ1JNX0FQSV9UT0tFTjtcbiAgY29uc3QgaGVhZGVyVG9rZW4gPSByZXEuaGVhZGVyc1tcIngtY3JtLXRva2VuXCJdO1xuICBjb25zdCB0b2tlbiA9IEFycmF5LmlzQXJyYXkoaGVhZGVyVG9rZW4pID8gaGVhZGVyVG9rZW5bMF0gOiBoZWFkZXJUb2tlbjtcbiAgaWYgKGV4cGVjdGVkVG9rZW4gJiYgdG9rZW4gIT09IGV4cGVjdGVkVG9rZW4pIHtcbiAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlS2V5KSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogXCJTdXBhYmFzZemFjee9rue8uuWksVwiIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChyZXEubWV0aG9kID09PSBcIkdFVFwiKSB7XG4gICAgY29uc3QgeyBrZXl3b3JkIH0gPSByZXEucXVlcnk7XG4gICAgY29uc3Qga2V5d29yZFZhbHVlID0gdHlwZW9mIGtleXdvcmQgPT09IFwic3RyaW5nXCIgPyBrZXl3b3JkLnRyaW0oKSA6IFwiXCI7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qgcm93cyA9IGF3YWl0IHF1ZXJ5VGVtcGxhdGVzKHsga2V5d29yZDoga2V5d29yZFZhbHVlIH0pO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBpdGVtczogcm93cy5tYXAoKHJvdykgPT4gbm9ybWFsaXplVGVtcGxhdGVSb3cocm93KSlcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZT8ubWVzc2FnZSB8fCBcIuafpeivouWksei0pVwiIH0pO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAocmVxLm1ldGhvZCA9PT0gXCJQT1NUXCIpIHtcbiAgICBjb25zdCBib2R5ID0gKHJlcS5ib2R5IHx8IHt9KSBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICAgIGNvbnN0IG5hbWUgPSB0b1N0cmluZ1NhZmUoYm9keS5uYW1lKTtcbiAgICBjb25zdCB0eXBlID0gdG9TdHJpbmdTYWZlKGJvZHkudHlwZSk7XG4gICAgY29uc3QgY3JlYXRlZEJ5ID0gdG9TdHJpbmdTYWZlKGJvZHkuY3JlYXRlZEJ5KTtcbiAgICBjb25zdCByZXBvcnRUaXRsZSA9IHRvU3RyaW5nU2FmZShib2R5LnJlcG9ydFRpdGxlKTtcbiAgICBjb25zdCBwYXJhbVR5cGUgPSB0b1N0cmluZ1NhZmUoYm9keS5wYXJhbVR5cGUpO1xuICAgIGNvbnN0IHRleHQgPSB0b1N0cmluZ1NhZmUoYm9keS50ZXh0KTtcbiAgICBjb25zdCBwYXRoID0gdG9TdHJpbmdTYWZlKGJvZHkucGF0aCk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qgcm93ID0gYXdhaXQgaW5zZXJ0VGVtcGxhdGUoe1xuICAgICAgICBuYW1lLFxuICAgICAgICB0eXBlLFxuICAgICAgICBjcmVhdGVkQnksXG4gICAgICAgIC4uLihyZXBvcnRUaXRsZSA/IHsgcmVwb3J0VGl0bGUgfSA6IHt9KSxcbiAgICAgICAgLi4uKHBhcmFtVHlwZSA/IHsgcGFyYW1UeXBlIH0gOiB7fSksXG4gICAgICAgIC4uLih0ZXh0ID8geyB0ZXh0IH0gOiB7fSksXG4gICAgICAgIC4uLihwYXRoID8geyBwYXRoIH0gOiB7fSlcbiAgICAgIH0gYXMgYW55KTtcbiAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHsgaXRlbTogbm9ybWFsaXplVGVtcGxhdGVSb3cocm93KSB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9IGNhdGNoIChlOiBhbnkpIHtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGU/Lm1lc3NhZ2UgfHwgXCLliJvlu7rlpLHotKVcIiB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICByZXMuc2V0SGVhZGVyKFwiQWxsb3dcIiwgXCJHRVQsUE9TVFwiKTtcbiAgcmVzLnN0YXR1cyg0MDUpLmVuZChcIk1ldGhvZCBOb3QgQWxsb3dlZFwiKTtcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJyZWFkRW52IiwidmFsdWUiLCJyYXciLCJ1bmRlZmluZWQiLCJTdHJpbmciLCJ0cmltIiwicmVwbGFjZSIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJTVVBBQkFTRV9TRVJWSUNFX0tFWSIsInN1cGFiYXNlU2VydmljZUtleSIsInN1cGFiYXNlIiwiYWRtaW5TdXBhYmFzZSIsImdldFRlbXBsYXRlSWQiLCJzb3VyY2UiLCJpZCIsInRlbXBfaWQiLCJ0ZW1wbGF0ZV9pZCIsInRlbXBJZCIsInRlbXBsYXRlSWQiLCJ1dWlkIiwibm9ybWFsaXplVGVtcGxhdGVSb3ciLCJyb3ciLCJuYW1lIiwidGVtcF9uYW1lIiwidHlwZSIsInRlbXBfdHlwZSIsInBhdGgiLCJ0ZW1wX3BhdGgiLCJjcmVhdG9yIiwiY3JlYXRlZF9ieSIsImNyZWF0ZWRBdCIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkQXQiLCJ1cGRhdGVkX2F0IiwicXVlcnlUZW1wbGF0ZXMiLCJwYXJhbXMiLCJrZXl3b3JkIiwiaWRGaWVsZHMiLCJvcmRlckZpZWxkcyIsImJhc2VGaWVsZHMiLCJsYXN0RXJyb3IiLCJpZEZpZWxkIiwib3JkZXJGaWVsZCIsInF1ZXJ5IiwiZnJvbSIsInNlbGVjdCIsImxpbWl0IiwiaWxpa2UiLCJkYXRhIiwiZXJyb3IiLCJvcmRlciIsImFzY2VuZGluZyIsIkFycmF5IiwiaXNBcnJheSIsIm1zZyIsIm1lc3NhZ2UiLCJ0ZXN0IiwiRXJyb3IiLCJ0b1N0cmluZ1NhZmUiLCJpbnNlcnRUZW1wbGF0ZSIsIm5vd0lzbyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImNyZWF0ZWRCeSIsInJlcG9ydFRpdGxlIiwicGFyYW1UeXBlIiwidGV4dCIsImlucHV0UGF0aCIsInNhZmVQYXRoIiwiYmFzZUV4dHJhIiwicmVwb3J0X3RpdGxlIiwicGFyYW1fdHlwZSIsInBheWxvYWRDYW5kaWRhdGVzIiwidGVtcF90ZXh0IiwicGF5bG9hZCIsImluc2VydCIsIm1heWJlU2luZ2xlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImV4cGVjdGVkVG9rZW4iLCJDUk1fQVBJX1RPS0VOIiwiaGVhZGVyVG9rZW4iLCJoZWFkZXJzIiwidG9rZW4iLCJzdGF0dXMiLCJqc29uIiwibWV0aG9kIiwia2V5d29yZFZhbHVlIiwicm93cyIsIml0ZW1zIiwibWFwIiwiZSIsImJvZHkiLCJpdGVtIiwic2V0SGVhZGVyIiwiZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/templates/index.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftemplates&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctemplates%5Cindex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();