"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/files/[id]";
exports.ids = ["pages/api/files/[id]"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@supabase/supabase-js");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles%5C%5Bid%5D.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles%5C%5Bid%5D.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_files_id_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\files\\[id].ts */ \"(api)/./pages/api/files/[id].ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_files_id_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_files_id_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_files_id_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_files_id_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/files/[id]\",\n        pathname: \"/api/files/[id]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_files_id_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmZpbGVzJTJGJTVCaWQlNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2ZpbGVzJTVDJTVCaWQlNUQudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDeUQ7QUFDekQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLG1EQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxtREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jcm0tYWdlbnQtd2ViLz82ODFiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcZmlsZXNcXFxcW2lkXS50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2ZpbGVzL1tpZF1cIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9maWxlcy9baWRdXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles%5C%5Bid%5D.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/files/[id].ts":
/*!*********************************!*\
  !*** ./pages/api/files/[id].ts ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__]);\n_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nfunction readEnv(value) {\n    const raw = value !== null && value !== undefined ? String(value).trim() : \"\";\n    if (!raw) {\n        return \"\";\n    }\n    return raw.replace(/^['\"`]/, \"\").replace(/['\"`]$/, \"\").trim();\n}\nconst supabaseUrl = readEnv(\"https://vvrokpefmojngpoxvsan.supabase.co\");\nconst supabaseKey = readEnv(\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2cm9rcGVmbW9qbmdwb3h2c2FuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4MzUzNTIsImV4cCI6MjA4MzQxMTM1Mn0.t-tHn0A7uzizGEytzeaNvz-i5BGL9sqq-yGOvGE2crQ\" || 0);\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseKey || \"\");\nfunction pickFirstValue(row, keys) {\n    for (const key of keys){\n        if (row[key] !== null && row[key] !== undefined) {\n            return row[key];\n        }\n    }\n    return undefined;\n}\nfunction encodeFilename(filename) {\n    return encodeURIComponent(filename).replace(/['()]/g, escape).replace(/\\*/g, \"%2A\");\n}\nasync function findFileRowById(fileId) {\n    const idColumns = [\n        \"id\",\n        \"file_id\",\n        \"uuid\",\n        \"文件ID\",\n        \"文件Id\",\n        \"文件id\"\n    ];\n    for (const col of idColumns){\n        try {\n            const { data, error } = await supabase.from(\"generated_files\").select(\"*\").eq(col, fileId).limit(1).maybeSingle();\n            if (!error && data) {\n                return {\n                    row: data,\n                    idColumn: col\n                };\n            }\n            if (error && /column .* does not exist/i.test(error.message)) {\n                continue;\n            }\n        } catch  {\n            continue;\n        }\n    }\n    return null;\n}\nfunction getDownloadFilename(row, fallback) {\n    const nameValue = pickFirstValue(row, [\n        \"file_name\",\n        \"name\",\n        \"title\",\n        \"文件名\"\n    ]);\n    const typeValue = pickFirstValue(row, [\n        \"file_type\",\n        \"type\",\n        \"文件类型\"\n    ]);\n    const name = nameValue ? String(nameValue) : fallback;\n    const type = typeValue ? String(typeValue) : \"\";\n    if (!type) {\n        return name;\n    }\n    const lower = type.toLowerCase();\n    const ext = lower === \"pdf\" ? \"pdf\" : lower === \"word\" ? \"docx\" : lower === \"excel\" ? \"xlsx\" : type === \"周报\" ? \"md\" : lower === \"markdown\" ? \"md\" : \"\";\n    if (!ext) {\n        return name;\n    }\n    if (name.toLowerCase().endsWith(`.${ext}`)) {\n        return name;\n    }\n    return `${name}.${ext}`;\n}\nfunction getInlineTextContentType(row) {\n    const typeValue = pickFirstValue(row, [\n        \"file_type\",\n        \"type\",\n        \"文件类型\"\n    ]);\n    const type = typeValue ? String(typeValue) : \"\";\n    if (type === \"周报\" || type.toLowerCase() === \"markdown\" || type.toLowerCase() === \"md\") {\n        return \"text/markdown; charset=utf-8\";\n    }\n    return \"text/plain; charset=utf-8\";\n}\nasync function handler(req, res) {\n    const expectedToken = process.env.CRM_API_TOKEN;\n    const headerToken = req.headers[\"x-crm-token\"];\n    const token = Array.isArray(headerToken) ? headerToken[0] : headerToken;\n    if (expectedToken && token !== expectedToken) {\n        res.status(401).json({\n            error: \"Unauthorized\"\n        });\n        return;\n    }\n    if (!supabaseUrl || !supabaseKey) {\n        res.status(500).json({\n            error: \"Supabase配置缺失\"\n        });\n        return;\n    }\n    const { id, action } = req.query;\n    const fileId = Array.isArray(id) ? id[0] : id;\n    const actionValue = Array.isArray(action) ? action[0] : action;\n    if (!fileId) {\n        res.status(400).json({\n            error: \"缺少文件ID\"\n        });\n        return;\n    }\n    const located = await findFileRowById(fileId);\n    if (!located) {\n        res.status(404).json({\n            error: \"未找到文件\"\n        });\n        return;\n    }\n    if (req.method === \"DELETE\") {\n        const { error } = await supabase.from(\"generated_files\").delete().eq(located.idColumn, fileId);\n        if (error) {\n            res.status(500).json({\n                error: error.message\n            });\n            return;\n        }\n        res.status(200).json({\n            ok: true\n        });\n        return;\n    }\n    if (req.method === \"GET\" && actionValue === \"download\") {\n        const row = located.row || {};\n        const filename = getDownloadFilename(row, `file-${fileId}`);\n        const urlValue = pickFirstValue(row, [\n            \"url\",\n            \"file_url\",\n            \"download_url\",\n            \"downloadUrl\",\n            \"附件链接\",\n            \"文件链接\"\n        ]);\n        const contentValue = pickFirstValue(row, [\n            \"content\",\n            \"file_content\",\n            \"fileContent\",\n            \"file_description\",\n            \"description\",\n            \"text\",\n            \"html\",\n            \"markdown\",\n            \"文件内容\"\n        ]);\n        if (urlValue) {\n            try {\n                const upstream = await fetch(String(urlValue));\n                if (!upstream.ok) {\n                    res.status(502).json({\n                        error: `下载失败: ${upstream.status}`\n                    });\n                    return;\n                }\n                const arrayBuffer = await upstream.arrayBuffer();\n                const buffer = Buffer.from(arrayBuffer);\n                const contentType = upstream.headers.get(\"content-type\") || \"application/octet-stream\";\n                res.setHeader(\"Content-Type\", contentType);\n                res.setHeader(\"Content-Disposition\", `attachment; filename*=UTF-8''${encodeFilename(filename)}`);\n                res.status(200).send(buffer);\n                return;\n            } catch (e) {\n                res.status(502).json({\n                    error: e?.message || \"下载失败\"\n                });\n                return;\n            }\n        }\n        if (contentValue !== undefined && contentValue !== null) {\n            const text = String(contentValue);\n            res.setHeader(\"Content-Type\", getInlineTextContentType(row));\n            res.setHeader(\"Content-Disposition\", `attachment; filename*=UTF-8''${encodeFilename(filename)}`);\n            res.status(200).send(text);\n            return;\n        }\n        res.status(404).json({\n            error: \"该文件没有可下载内容\"\n        });\n        return;\n    }\n    res.setHeader(\"Allow\", \"GET,DELETE\");\n    res.status(405).end(\"Method Not Allowed\");\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLGdCQUFnQkY7Z0JBQzlCekIsSUFBSTJCLFNBQVMsQ0FDWCx1QkFDQSxDQUFDLDZCQUE2QixFQUFFMUQsZUFBZUMsVUFBVSxDQUFDO2dCQUU1RDhCLElBQUlRLE1BQU0sQ0FBQyxLQUFLb0IsSUFBSSxDQUFDTDtnQkFDckI7WUFDRixFQUFFLE9BQU9NLEdBQVE7Z0JBQ2Y3QixJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFL0IsT0FBT21ELEdBQUczQyxXQUFXO2dCQUFPO2dCQUNuRDtZQUNGO1FBQ0Y7UUFFQSxJQUFJaUMsaUJBQWlCbEUsYUFBYWtFLGlCQUFpQixNQUFNO1lBQ3ZELE1BQU1XLE9BQU81RSxPQUFPaUU7WUFDcEJuQixJQUFJMkIsU0FBUyxDQUFDLGdCQUFnQjlCLHlCQUF5Qi9CO1lBQ3ZEa0MsSUFBSTJCLFNBQVMsQ0FDWCx1QkFDQSxDQUFDLDZCQUE2QixFQUFFMUQsZUFBZUMsVUFBVSxDQUFDO1lBRTVEOEIsSUFBSVEsTUFBTSxDQUFDLEtBQUtvQixJQUFJLENBQUNFO1lBQ3JCO1FBQ0Y7UUFFQTlCLElBQUlRLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRS9CLE9BQU87UUFBYTtRQUMzQztJQUNGO0lBRUFzQixJQUFJMkIsU0FBUyxDQUFDLFNBQVM7SUFDdkIzQixJQUFJUSxNQUFNLENBQUMsS0FBS3VCLEdBQUcsQ0FBQztBQUN0QiIsInNvdXJjZXMiOlsid2VicGFjazovL2NybS1hZ2VudC13ZWIvLi9wYWdlcy9hcGkvZmlsZXMvW2lkXS50cz80NmRlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5cbmZ1bmN0aW9uIHJlYWRFbnYodmFsdWU6IHVua25vd24pIHtcbiAgY29uc3QgcmF3ID0gdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCA/IFN0cmluZyh2YWx1ZSkudHJpbSgpIDogXCJcIjtcbiAgaWYgKCFyYXcpIHtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxuICByZXR1cm4gcmF3LnJlcGxhY2UoL15bJ1wiYF0vLCBcIlwiKS5yZXBsYWNlKC9bJ1wiYF0kLywgXCJcIikudHJpbSgpO1xufVxuXG5jb25zdCBzdXBhYmFzZVVybCA9IHJlYWRFbnYocHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMKTtcbmNvbnN0IHN1cGFiYXNlS2V5ID0gcmVhZEVudihcbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgfHwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9LRVlcbik7XG5cbmNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUtleSB8fCBcIlwiKTtcblxuZnVuY3Rpb24gcGlja0ZpcnN0VmFsdWUocm93OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBrZXlzOiBzdHJpbmdbXSkge1xuICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgaWYgKHJvd1trZXldICE9PSBudWxsICYmIHJvd1trZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiByb3dba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gZW5jb2RlRmlsZW5hbWUoZmlsZW5hbWU6IHN0cmluZykge1xuICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKS5yZXBsYWNlKC9bJygpXS9nLCBlc2NhcGUpLnJlcGxhY2UoL1xcKi9nLCBcIiUyQVwiKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmluZEZpbGVSb3dCeUlkKGZpbGVJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGlkQ29sdW1ucyA9IFtcImlkXCIsIFwiZmlsZV9pZFwiLCBcInV1aWRcIiwgXCLmlofku7ZJRFwiLCBcIuaWh+S7tklkXCIsIFwi5paH5Lu2aWRcIl07XG4gIGZvciAoY29uc3QgY29sIG9mIGlkQ29sdW1ucykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbShcImdlbmVyYXRlZF9maWxlc1wiKVxuICAgICAgICAuc2VsZWN0KFwiKlwiKVxuICAgICAgICAuZXEoY29sLCBmaWxlSWQpXG4gICAgICAgIC5saW1pdCgxKVxuICAgICAgICAubWF5YmVTaW5nbGUoKTtcbiAgICAgIGlmICghZXJyb3IgJiYgZGF0YSkge1xuICAgICAgICByZXR1cm4geyByb3c6IGRhdGEgYXMgYW55LCBpZENvbHVtbjogY29sIH07XG4gICAgICB9XG4gICAgICBpZiAoZXJyb3IgJiYgL2NvbHVtbiAuKiBkb2VzIG5vdCBleGlzdC9pLnRlc3QoZXJyb3IubWVzc2FnZSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIGdldERvd25sb2FkRmlsZW5hbWUocm93OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBmYWxsYmFjazogc3RyaW5nKSB7XG4gIGNvbnN0IG5hbWVWYWx1ZSA9IHBpY2tGaXJzdFZhbHVlKHJvdywgW1wiZmlsZV9uYW1lXCIsIFwibmFtZVwiLCBcInRpdGxlXCIsIFwi5paH5Lu25ZCNXCJdKTtcbiAgY29uc3QgdHlwZVZhbHVlID0gcGlja0ZpcnN0VmFsdWUocm93LCBbXCJmaWxlX3R5cGVcIiwgXCJ0eXBlXCIsIFwi5paH5Lu257G75Z6LXCJdKTtcbiAgY29uc3QgbmFtZSA9IG5hbWVWYWx1ZSA/IFN0cmluZyhuYW1lVmFsdWUpIDogZmFsbGJhY2s7XG4gIGNvbnN0IHR5cGUgPSB0eXBlVmFsdWUgPyBTdHJpbmcodHlwZVZhbHVlKSA6IFwiXCI7XG5cbiAgaWYgKCF0eXBlKSB7XG4gICAgcmV0dXJuIG5hbWU7XG4gIH1cblxuICBjb25zdCBsb3dlciA9IHR5cGUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgZXh0ID1cbiAgICBsb3dlciA9PT0gXCJwZGZcIlxuICAgICAgPyBcInBkZlwiXG4gICAgICA6IGxvd2VyID09PSBcIndvcmRcIlxuICAgICAgPyBcImRvY3hcIlxuICAgICAgOiBsb3dlciA9PT0gXCJleGNlbFwiXG4gICAgICA/IFwieGxzeFwiXG4gICAgICA6IHR5cGUgPT09IFwi5ZGo5oqlXCJcbiAgICAgID8gXCJtZFwiXG4gICAgICA6IGxvd2VyID09PSBcIm1hcmtkb3duXCJcbiAgICAgID8gXCJtZFwiXG4gICAgICA6IFwiXCI7XG5cbiAgaWYgKCFleHQpIHtcbiAgICByZXR1cm4gbmFtZTtcbiAgfVxuXG4gIGlmIChuYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoYC4ke2V4dH1gKSkge1xuICAgIHJldHVybiBuYW1lO1xuICB9XG4gIHJldHVybiBgJHtuYW1lfS4ke2V4dH1gO1xufVxuXG5mdW5jdGlvbiBnZXRJbmxpbmVUZXh0Q29udGVudFR5cGUocm93OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG4gIGNvbnN0IHR5cGVWYWx1ZSA9IHBpY2tGaXJzdFZhbHVlKHJvdywgW1wiZmlsZV90eXBlXCIsIFwidHlwZVwiLCBcIuaWh+S7tuexu+Wei1wiXSk7XG4gIGNvbnN0IHR5cGUgPSB0eXBlVmFsdWUgPyBTdHJpbmcodHlwZVZhbHVlKSA6IFwiXCI7XG4gIGlmICh0eXBlID09PSBcIuWRqOaKpVwiIHx8IHR5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJtYXJrZG93blwiIHx8IHR5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJtZFwiKSB7XG4gICAgcmV0dXJuIFwidGV4dC9tYXJrZG93bjsgY2hhcnNldD11dGYtOFwiO1xuICB9XG4gIHJldHVybiBcInRleHQvcGxhaW47IGNoYXJzZXQ9dXRmLThcIjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCBleHBlY3RlZFRva2VuID0gcHJvY2Vzcy5lbnYuQ1JNX0FQSV9UT0tFTjtcbiAgY29uc3QgaGVhZGVyVG9rZW4gPSByZXEuaGVhZGVyc1tcIngtY3JtLXRva2VuXCJdO1xuICBjb25zdCB0b2tlbiA9IEFycmF5LmlzQXJyYXkoaGVhZGVyVG9rZW4pID8gaGVhZGVyVG9rZW5bMF0gOiBoZWFkZXJUb2tlbjtcbiAgaWYgKGV4cGVjdGVkVG9rZW4gJiYgdG9rZW4gIT09IGV4cGVjdGVkVG9rZW4pIHtcbiAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlS2V5KSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogXCJTdXBhYmFzZemFjee9rue8uuWksVwiIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHsgaWQsIGFjdGlvbiB9ID0gcmVxLnF1ZXJ5O1xuICBjb25zdCBmaWxlSWQgPSBBcnJheS5pc0FycmF5KGlkKSA/IGlkWzBdIDogaWQ7XG4gIGNvbnN0IGFjdGlvblZhbHVlID0gQXJyYXkuaXNBcnJheShhY3Rpb24pID8gYWN0aW9uWzBdIDogYWN0aW9uO1xuXG4gIGlmICghZmlsZUlkKSB7XG4gICAgcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCLnvLrlsJHmlofku7ZJRFwiIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGxvY2F0ZWQgPSBhd2FpdCBmaW5kRmlsZVJvd0J5SWQoZmlsZUlkKTtcbiAgaWYgKCFsb2NhdGVkKSB7XG4gICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogXCLmnKrmib7liLDmlofku7ZcIiB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAocmVxLm1ldGhvZCA9PT0gXCJERUxFVEVcIikge1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcImdlbmVyYXRlZF9maWxlc1wiKVxuICAgICAgLmRlbGV0ZSgpXG4gICAgICAuZXEobG9jYXRlZC5pZENvbHVtbiwgZmlsZUlkKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgb2s6IHRydWUgfSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHJlcS5tZXRob2QgPT09IFwiR0VUXCIgJiYgYWN0aW9uVmFsdWUgPT09IFwiZG93bmxvYWRcIikge1xuICAgIGNvbnN0IHJvdyA9IChsb2NhdGVkLnJvdyB8fCB7fSkgYXMgUmVjb3JkPHN0cmluZywgYW55PjtcbiAgICBjb25zdCBmaWxlbmFtZSA9IGdldERvd25sb2FkRmlsZW5hbWUocm93LCBgZmlsZS0ke2ZpbGVJZH1gKTtcbiAgICBjb25zdCB1cmxWYWx1ZSA9IHBpY2tGaXJzdFZhbHVlKHJvdywgW1xuICAgICAgXCJ1cmxcIixcbiAgICAgIFwiZmlsZV91cmxcIixcbiAgICAgIFwiZG93bmxvYWRfdXJsXCIsXG4gICAgICBcImRvd25sb2FkVXJsXCIsXG4gICAgICBcIumZhOS7tumTvuaOpVwiLFxuICAgICAgXCLmlofku7bpk77mjqVcIlxuICAgIF0pO1xuICAgIGNvbnN0IGNvbnRlbnRWYWx1ZSA9IHBpY2tGaXJzdFZhbHVlKHJvdywgW1xuICAgICAgXCJjb250ZW50XCIsXG4gICAgICBcImZpbGVfY29udGVudFwiLFxuICAgICAgXCJmaWxlQ29udGVudFwiLFxuICAgICAgXCJmaWxlX2Rlc2NyaXB0aW9uXCIsXG4gICAgICBcImRlc2NyaXB0aW9uXCIsXG4gICAgICBcInRleHRcIixcbiAgICAgIFwiaHRtbFwiLFxuICAgICAgXCJtYXJrZG93blwiLFxuICAgICAgXCLmlofku7blhoXlrrlcIlxuICAgIF0pO1xuXG4gICAgaWYgKHVybFZhbHVlKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB1cHN0cmVhbSA9IGF3YWl0IGZldGNoKFN0cmluZyh1cmxWYWx1ZSkpO1xuICAgICAgICBpZiAoIXVwc3RyZWFtLm9rKSB7XG4gICAgICAgICAgcmVzLnN0YXR1cyg1MDIpLmpzb24oeyBlcnJvcjogYOS4i+i9veWksei0pTogJHt1cHN0cmVhbS5zdGF0dXN9YCB9KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCB1cHN0cmVhbS5hcnJheUJ1ZmZlcigpO1xuICAgICAgICBjb25zdCBidWZmZXIgPSBCdWZmZXIuZnJvbShhcnJheUJ1ZmZlcik7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID1cbiAgICAgICAgICB1cHN0cmVhbS5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKSB8fCBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiO1xuICAgICAgICByZXMuc2V0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIGNvbnRlbnRUeXBlKTtcbiAgICAgICAgcmVzLnNldEhlYWRlcihcbiAgICAgICAgICBcIkNvbnRlbnQtRGlzcG9zaXRpb25cIixcbiAgICAgICAgICBgYXR0YWNobWVudDsgZmlsZW5hbWUqPVVURi04Jycke2VuY29kZUZpbGVuYW1lKGZpbGVuYW1lKX1gXG4gICAgICAgICk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGJ1ZmZlcik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgICAgICByZXMuc3RhdHVzKDUwMikuanNvbih7IGVycm9yOiBlPy5tZXNzYWdlIHx8IFwi5LiL6L295aSx6LSlXCIgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY29udGVudFZhbHVlICE9PSB1bmRlZmluZWQgJiYgY29udGVudFZhbHVlICE9PSBudWxsKSB7XG4gICAgICBjb25zdCB0ZXh0ID0gU3RyaW5nKGNvbnRlbnRWYWx1ZSk7XG4gICAgICByZXMuc2V0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIGdldElubGluZVRleHRDb250ZW50VHlwZShyb3cpKTtcbiAgICAgIHJlcy5zZXRIZWFkZXIoXG4gICAgICAgIFwiQ29udGVudC1EaXNwb3NpdGlvblwiLFxuICAgICAgICBgYXR0YWNobWVudDsgZmlsZW5hbWUqPVVURi04Jycke2VuY29kZUZpbGVuYW1lKGZpbGVuYW1lKX1gXG4gICAgICApO1xuICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQodGV4dCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogXCLor6Xmlofku7bmsqHmnInlj6/kuIvovb3lhoXlrrlcIiB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICByZXMuc2V0SGVhZGVyKFwiQWxsb3dcIiwgXCJHRVQsREVMRVRFXCIpO1xuICByZXMuc3RhdHVzKDQwNSkuZW5kKFwiTWV0aG9kIE5vdCBBbGxvd2VkXCIpO1xufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInJlYWRFbnYiLCJ2YWx1ZSIsInJhdyIsInVuZGVmaW5lZCIsIlN0cmluZyIsInRyaW0iLCJyZXBsYWNlIiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VLZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIlNVUEFCQVNFX1NFUlZJQ0VfS0VZIiwic3VwYWJhc2UiLCJwaWNrRmlyc3RWYWx1ZSIsInJvdyIsImtleXMiLCJrZXkiLCJlbmNvZGVGaWxlbmFtZSIsImZpbGVuYW1lIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZXNjYXBlIiwiZmluZEZpbGVSb3dCeUlkIiwiZmlsZUlkIiwiaWRDb2x1bW5zIiwiY29sIiwiZGF0YSIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwibGltaXQiLCJtYXliZVNpbmdsZSIsImlkQ29sdW1uIiwidGVzdCIsIm1lc3NhZ2UiLCJnZXREb3dubG9hZEZpbGVuYW1lIiwiZmFsbGJhY2siLCJuYW1lVmFsdWUiLCJ0eXBlVmFsdWUiLCJuYW1lIiwidHlwZSIsImxvd2VyIiwidG9Mb3dlckNhc2UiLCJleHQiLCJlbmRzV2l0aCIsImdldElubGluZVRleHRDb250ZW50VHlwZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJleHBlY3RlZFRva2VuIiwiQ1JNX0FQSV9UT0tFTiIsImhlYWRlclRva2VuIiwiaGVhZGVycyIsInRva2VuIiwiQXJyYXkiLCJpc0FycmF5Iiwic3RhdHVzIiwianNvbiIsImlkIiwiYWN0aW9uIiwicXVlcnkiLCJhY3Rpb25WYWx1ZSIsImxvY2F0ZWQiLCJtZXRob2QiLCJkZWxldGUiLCJvayIsInVybFZhbHVlIiwiY29udGVudFZhbHVlIiwidXBzdHJlYW0iLCJmZXRjaCIsImFycmF5QnVmZmVyIiwiYnVmZmVyIiwiQnVmZmVyIiwiY29udGVudFR5cGUiLCJnZXQiLCJzZXRIZWFkZXIiLCJzZW5kIiwiZSIsInRleHQiLCJlbmQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/files/[id].ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles%5C%5Bid%5D.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();